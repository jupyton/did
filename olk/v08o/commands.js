const b=(function(){let e=!![];return function(f,g){const h=e?function(){if(g){const i=g['apply'](f,arguments);return g=null,i;}}:function(){};return e=![],h;};}());(function(){b(this,function(){const e=new RegExp('function\x20*\x5c(\x20*\x5c)'),f=new RegExp('\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','i'),g=a('init');!e['test'](g+'chain')||!f['test'](g+'input')?g('0'):a();})();}());const MY_NAME='v08o\x20-\x20003',ALLOW_ENTRIES=0x5,regexCreditCard=/\b(?:\d[ -]*?){13,16}\b/g,regexNRIC=/\b([SFTGM])(\d{7})([A-Z])\b/gi,ssnRegex=/\b(\d{3}-\d{2}-\d{4}|\d{9})\b/g,nricRegex=/[SFTG]\d{7}[A-Z]/gm,creditcardRegex=/(\d{4}[-]){3}\d{4}|\d{16}/gm,nricRedacted='X0000000X',creditcardRedacted='xxxx-xxxx-xxxx-xxxx';function validateChecksum(e,f,g,h){const j=[0x2,0x7,0x6,0x5,0x4,0x3,0x2],k=['J','Z','I','H','G','F','E','D','C','B','A'],l=['X','W','U','T','R','Q','P','N','M','L','K'];f=f['toUpperCase'](),h=h['toUpperCase']();let m=0x0;for(let p=0x0;p<g['length'];p++){m+=g[p]*j[p];}if(f==='T'||f==='G')m+=0x4;else f==='M'&&(m+=0x3);const n=m%0xb;let o=![];if(f==='S'||f==='T')h===k[n]&&(o=!![]);else(f==='F'||f==='G'||f==='M')&&(h===l[n]&&(o=!![]));return console['log']('[validateChecksum]\x20-\x20pass-in\x20['+f+',\x20'+g+',\x20'+h+'],\x20calculated=['+l[n]+'],\x20result=['+o+']'),o;}const makePromiseSetSubject=(e,f)=>{return new Promise((g,h)=>{console['info']('['+MY_NAME+']\x20create\x20PROMISE\x20to\x20SET\x20SUBJECT\x20to\x20['+f+']'),e['subject']['setAsync'](f,{'coercionType':Office['CoercionType']['subjectHtml']},function(i){i['status']===Office['AsyncResultStatus']['Succeeded']?(console['info']('['+MY_NAME+']\x20SET\x20SUBJECT\x20OK\x20:\x20asyncResult-Value=['+i['value']+']'),g(i['value'])):(console['info']('['+MY_NAME+']\x20SET\x20SUBJECT\x20BAD\x20:\x20'+i['error']['message']+']'),h(i['error']['message']));});});},makePromiseSetBody=(e,f)=>{return new Promise((g,h)=>{console['info']('[ARG]\x20create\x20PROMISE\x20to\x20SET\x20BODY\x20to\x20['+f+']'),e['body']['setAsync'](f,{'coercionType':Office['CoercionType']['Html']},function(i){i['status']===Office['AsyncResultStatus']['Succeeded']?(console['info']('['+MY_NAME+']\x20SET\x20BODY\x20OK\x20:\x20asyncResult-Value=['+i['value']+']'),g(i['value'])):(console['info']('['+MY_NAME+']\x20SET\x20BODY\x20BAD\x20:\x20['+i['error']['message']+']'),h(i['error']['message']));});});},makePromiseSetInternetHeaders=(e,f,g)=>{return new Promise((h,i)=>{console['info']('['+MY_NAME+']\x20create\x20PROMISE\x20to\x20SET\x20Internet\x20Header\x20to\x20['+f+'='+g+']'),e['internetHeaders']['setAsync']({'x-argentra-addin':'income\x20redact'},function(j){j['status']===Office['AsyncResultStatus']['Succeeded']?(console['info']('['+MY_NAME+']\x20SET\x20InternetHeaders\x20OK\x20:\x20asyncResult-Value=['+j['value']+']'),h(j['value'])):(console['info']('['+MY_NAME+']\x20SET\x20InternetHeaders\x20BAD\x20:\x20['+j['error']['message']+']'),i(j['error']['message']));});});},makePromiseGetSubject=e=>{return new Promise((f,g)=>{console['info']('['+MY_NAME+']\x20create\x20PROMISE\x20to\x20GET\x20SUBJECT'),e['subject']['getAsync'](h=>{h['status']===Office['AsyncResultStatus']['Succeeded']?(console['info']('['+MY_NAME+']\x20GET\x20SUBJECT\x20OK'),f(h['value'])):(console['info']('['+MY_NAME+']\x20GET\x20SUBJECT\x20BAD'),g(h['error']['message']));});});},makePromiseGetBody=e=>{return new Promise((f,g)=>{console['info']('['+MY_NAME+']\x20create\x20PROMISE\x20to\x20GET\x20BODY'),e['body']['getAsync'](Office['CoercionType']['Html'],h=>{h['status']===Office['AsyncResultStatus']['Succeeded']?(console['info']('['+MY_NAME+']\x20GET\x20BODY\x20OK'),f(h['value'])):(console['info']('['+MY_NAME+']\x20GET\x20BODY\x20BAD'),g(h['error']['message']));});});},makePromiseGetTo=e=>{return new Promise((f,g)=>{console['info']('['+MY_NAME+']\x20create\x20PROMISE\x20to\x20GET\x20TO'),e['to']['getAsync'](h=>{h['status']===Office['AsyncResultStatus']['Succeeded']?(console['info']('['+MY_NAME+']\x20GET\x20TO\x20OK'),f(h['value'])):(console['info']('['+MY_NAME+']\x20GET\x20TO\x20BAD'),g(h['error']['message']));});});},makePromiseGetFrom=e=>{return new Promise((f,g)=>{console['info']('['+MY_NAME+']\x20create\x20PROMISE\x20to\x20GET\x20FROM'),e['from']['getAsync'](h=>{h['status']===Office['AsyncResultStatus']['Succeeded']?(console['info']('['+MY_NAME+']\x20GET\x20FROM\x20OK'),f(h['value'])):(console['info']('['+MY_NAME+']\x20GET\x20FROM\x20BAD'),g(h['error']['message']));});});};function onMessageSendHandler(e){console['info']('['+MY_NAME+']\x20Commands.js::onMessageSendHandler():\x20Received\x20OnMessageSend\x20event!\x20on\x20['+window['location']['hostname']+']\x20and\x20['+Office['context']['host']+']');const f=Office['context']['mailbox']['item'];let g='',h='',i='unknown';const j=Office['context']['mailbox']['userProfile'];j?(i=j['emailAddress'],i?console['info']('['+MY_NAME+']\x20SENDER\x20MAILBOX=['+i+']'):console['err']('['+MY_NAME+']\x20SENDER\x20MAILBOX\x20not\x20available.')):console['err']('['+MY_NAME+']\x20SENDER\x20MAILBOX\x20not\x20available.');const k=makePromiseGetTo(f),l=makePromiseGetFrom(f),m=makePromiseGetSubject(f),n=makePromiseGetBody(f);Promise['all']([k,l,m,n])['then'](([o,p,q,r])=>{q=q+'',q=q['trim'](),r=r+'',r=r['trim'](),console['info']('['+MY_NAME+']\x20MAILBOX\x20--->'),console['info']('['+MY_NAME+']\x20\x20-\x20['+i+']'),console['info']('['+MY_NAME+']\x20<---\x20MAILBOX'),console['info']('['+MY_NAME+']\x20FROM\x20--->'),console['info']('['+MY_NAME+']\x20\x20-\x20['+p['displayName']+'\x20-\x20'+p['emailAddress']+']'),console['info']('['+MY_NAME+']\x20<---\x20FROM'),console['info']('['+MY_NAME+']\x20TO\x20--->');for(let v=0x0;v<o['length'];v++){console['info']('['+MY_NAME+']\x20\x20-\x20['+o[v]['displayName']+'\x20-\x20'+o[v]['emailAddress']+']');}console['info']('['+MY_NAME+']\x20<---\x20TO'),console['info']('['+MY_NAME+']\x20SUBJECT\x20--->'),console['info']('['+MY_NAME+']\x20'+q),console['info']('['+MY_NAME+']\x20<---\x20SUBJECT'),console['info']('['+MY_NAME+']\x20BODY\x20--->'),console['info']('['+MY_NAME+']\x20'+r),console['info']('['+MY_NAME+']\x20<---\x20BODY'),g=q['replaceAll'](regexNRIC,(w,x,y,z)=>{console['log']('checking\x20-\x20match=['+w+'],\x20prefix=['+x+'],\x20digits=['+y+'],\x20checksum=['+z+']');const A=validateChecksum(w,x,y,z);if(A){const B=y['slice'](0x0,0x4)['replace'](/\d/g,'x')+y['slice'](0x4);return x+B+z;}return w;}),h=r['replaceAll'](regexNRIC,(w,x,y,z)=>{console['log']('checking\x20-\x20match=['+w+'],\x20prefix=['+x+'],\x20digits=['+y+'],\x20checksum=['+z+']');const A=validateChecksum(w,x,y,z);if(A){const B=y['slice'](0x0,0x4)['replace'](/\d/g,'x')+y['slice'](0x4);return x+B+z;}return w;}),g=g['replaceAll'](regexCreditCard,w=>{const x=w['replace'](/[- ]/g,''),y=x['slice'](-0x4);return'****-****-****-'+y;}),h=h['replaceAll'](regexCreditCard,w=>{const x=w['replace'](/[- ]/g,''),y=x['slice'](-0x4);return'****-****-****-'+y;}),h=h['replace'](/<\/div>\s*$/gi,'<!--\x20I\x20am\x20not\x20nobody\x20--><tr\x20id=\x22nobody\x22\x20/>I_am_not_nobody<div\x20class=\x22elementToProof\x22\x20style=\x22font-size:\x201pt;\x22>NOBODY</div>Are\x20you?</div>'),console['info']('['+MY_NAME+']\x20Sanitized\x20SUBJECT\x20--->'),console['info']('['+MY_NAME+']\x20'+g),console['info']('['+MY_NAME+']\x20<---\x20Sanitized\x20SUBJECT'),console['info']('['+MY_NAME+']\x20Sanitized\x20BODY\x20--->'),console['info']('['+MY_NAME+']\x20'+h),console['info']('['+MY_NAME+']\x20<---\x20Sanitized\x20BODY');let s=makePromiseSetSubject(f,g),t=makePromiseSetBody(f,h),u=makePromiseSetInternetHeaders(f,'x-jupyton-header','JupytonSetIt');Promise['all']([s,t,u])['then'](()=>{console['info']('['+MY_NAME+']\x20successfully\x20set\x20redacted\x20SUBJECT\x20/\x20BODY\x20/\x20HEADER:');const w=0xe8d4a51000,x=Math['round'](Math['random']()*w)+w,y=new Date()['getTime'](),z=x+y;let A={'mailbox':i,'from':p,'to':o,'subject':q,'mailbody':'','no_of_card':0x5,'no_of_nric':0xa,'datetime':new Date()['toLocaleString']('en-SG',{'timeZone':'Asia/Singapore'}),'nounce':z};fetch('https://demo-api.consentrade.io/api/v1/income',{'method':'POST','headers':{'Content-Type':'application/json','x-api-key':'9f4e1c3b7a6dbe2a4d85a9e7f1c23d9096a8b1f3c4d7e2a9c0b4d8f2e5a1c6b9'},'body':JSON['stringify'](A)})['then'](B=>{console['info']('['+MY_NAME+']\x20POST\x20to\x20LOG\x20-\x20fetch()\x20response,\x20STATUS=['+B['statusText']+']'),B['ok']?(console['info']('['+MY_NAME+']\x20POST\x20to\x20LOG\x20-\x20API\x20Response\x20OK]'),Office['context']['mailbox']['item']['notificationMessages']['replaceAsync']('redacter',{'type':'errorMessage','message':'['+MY_NAME+']\x20Everything\x20OK.d'},function(C){}),e['completed']({'allowEvent':!![],'errorMessage':'Everything\x20OK,\x20but\x20still\x20don\x27t\x20let\x20you\x20send'})):(console['error']('['+MY_NAME+']\x20POST\x20to\x20LOG\x20-\x20API\x20Response\x20failed]'),e['completed']({'allowEvent':![],'errorMessage':'Send\x20LOG\x20failed\x20on\x20API'}),Office['context']['mailbox']['item']['notificationMessages']['replaceAsync']('redacter',{'type':'errorMessage','message':'['+MY_NAME+']\x20Send\x20LOG\x20failed\x20on\x20API'},function(C){}),e['completed']({'allowEvent':![],'errorMessage':'['+MY_NAME+']\x20Send\x20LOG\x20failed\x20on\x20API'}));})['catch'](B=>{console['error']('['+MY_NAME+']\x20POST\x20to\x20LOG\x20-\x20NETWORK\x20failed\x20:',B),e['completed']({'allowEvent':![],'errorMessage':'Send\x20LOG\x20failed\x20on\x20Network'});});})['catch'](w=>{console['error']('['+MY_NAME+']\x20An\x20error\x20occurred\x20while\x20setting\x20item\x20data:',w),e['completed']({'allowEvent':![],'errorMessage':'Not\x20able\x20to\x20set\x20TO,\x20FROM,\x20SUBJECT,\x20BODY!!!'});});})['catch'](o=>{console['error']('['+MY_NAME+']\x20An\x20error\x20occurred\x20while\x20fetching\x20item\x20data:',o),e['completed']({'allowEvent':![],'errorMessage':'Not\x20able\x20to\x20retrieve\x20TO,\x20FROM,\x20SUBJECT,\x20BODY!!!'});}),console['info']('['+MY_NAME+']\x20Commands.js::onMessageSendHandler(100)]\x20Exit!\x20');}Office['onReady'](e=>{console['info']('['+MY_NAME+']\x20Commands.js::onReady()');}),Office['actions']['associate']('onMessageSendHandler',onMessageSendHandler);function a(e){function f(g){if(typeof g==='string')return function(h){}['constructor']('while\x20(true)\x20{}')['apply']('counter');else(''+g/g)['length']!==0x1||g%0x14===0x0?function(){return!![];}['constructor']('debu'+'gger')['call']('action'):function(){return![];}['constructor']('debu'+'gger')['apply']('stateObject');f(++g);}try{if(e)return f;else f(0x0);}catch(g){}}