const d=(function(){let g=!![];return function(h,i){const j=g?function(){if(i){const k=i['apply'](h,arguments);return i=null,k;}}:function(){};return g=![],j;};}()),c=d(this,function(){return c['toString']()['search']('(((.+)+)+)+$')['toString']()['constructor'](c)['search']('(((.+)+)+)+$');});c();const b=(function(){let g=!![];return function(h,i){const j=g?function(){if(i){const k=i['apply'](h,arguments);return i=null,k;}}:function(){};return g=![],j;};}());(function(){b(this,function(){const g=new RegExp('function\x20*\x5c(\x20*\x5c)'),h=new RegExp('\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','i'),i=a('init');!g['test'](i+'chain')||!h['test'](i+'input')?i('0'):a();})();}());const MY_NAME='v08o\x20-\x20001',ALLOW_ENTRIES=0x5,regexCreditCard=/\b(?:\d[ -]*?){13,16}\b/g,regexNRIC=/\b([SFTGM])(\d{7})([A-Z])\b/gi,ssnRegex=/\b(\d{3}-\d{2}-\d{4}|\d{9})\b/g,nricRegex=/[SFTG]\d{7}[A-Z]/gm,creditcardRegex=/(\d{4}[-]){3}\d{4}|\d{16}/gm,nricRedacted='X0000000X',creditcardRedacted='xxxx-xxxx-xxxx-xxxx';function validateChecksum(g,h,j,k){const l=[0x2,0x7,0x6,0x5,0x4,0x3,0x2],m=['J','Z','I','H','G','F','E','D','C','B','A'],n=['X','W','U','T','R','Q','P','N','M','L','K'];h=h['toUpperCase'](),k=k['toUpperCase']();let o=0x0;for(let r=0x0;r<j['length'];r++){o+=j[r]*l[r];}if(h==='T'||h==='G')o+=0x4;else h==='M'&&(o+=0x3);const p=o%0xb;let q=![];if(h==='S'||h==='T')k===m[p]&&(q=!![]);else(h==='F'||h==='G'||h==='M')&&(k===n[p]&&(q=!![]));return console['log']('[validateChecksum]\x20-\x20pass-in\x20['+h+',\x20'+j+',\x20'+k+'],\x20calculated=['+n[p]+'],\x20result=['+q+']'),q;}const makePromiseSetSubject=(g,h)=>{return new Promise((i,j)=>{console['info']('['+MY_NAME+']\x20create\x20PROMISE\x20to\x20SET\x20SUBJECT\x20to\x20['+h+']'),g['subject']['setAsync'](h,{'coercionType':Office['CoercionType']['subjectHtml']},function(k){k['status']===Office['AsyncResultStatus']['Succeeded']?(console['info']('['+MY_NAME+']\x20SET\x20SUBJECT\x20OK\x20:\x20asyncResult-Value=['+k['value']+']'),i(k['value'])):(console['info']('['+MY_NAME+']\x20SET\x20SUBJECT\x20BAD\x20:\x20'+k['error']['message']+']'),j(k['error']['message']));});});},makePromiseSetBody=(g,h)=>{return new Promise((i,j)=>{console['info']('[ARG]\x20create\x20PROMISE\x20to\x20SET\x20BODY\x20to\x20['+h+']'),g['body']['setAsync'](h,{'coercionType':Office['CoercionType']['Html']},function(k){k['status']===Office['AsyncResultStatus']['Succeeded']?(console['info']('['+MY_NAME+']\x20SET\x20BODY\x20OK\x20:\x20asyncResult-Value=['+k['value']+']'),i(k['value'])):(console['info']('['+MY_NAME+']\x20SET\x20BODY\x20BAD\x20:\x20['+k['error']['message']+']'),j(k['error']['message']));});});},makePromiseSetInternetHeaders=(g,h,i)=>{return new Promise((j,k)=>{console['info']('['+MY_NAME+']\x20create\x20PROMISE\x20to\x20SET\x20Internet\x20Header\x20to\x20['+h+'='+i+']'),g['internetHeaders']['setAsync']({'x-argentra-addin':'income\x20redact'},function(l){l['status']===Office['AsyncResultStatus']['Succeeded']?(console['info']('['+MY_NAME+']\x20SET\x20InternetHeaders\x20OK\x20:\x20asyncResult-Value=['+l['value']+']'),j(l['value'])):(console['info']('['+MY_NAME+']\x20SET\x20InternetHeaders\x20BAD\x20:\x20['+l['error']['message']+']'),k(l['error']['message']));});});},makePromiseGetSubject=g=>{return new Promise((h,i)=>{console['info']('['+MY_NAME+']\x20create\x20PROMISE\x20to\x20GET\x20SUBJECT'),g['subject']['getAsync'](j=>{j['status']===Office['AsyncResultStatus']['Succeeded']?(console['info']('['+MY_NAME+']\x20GET\x20SUBJECT\x20OK'),h(j['value'])):(console['info']('['+MY_NAME+']\x20GET\x20SUBJECT\x20BAD'),i(j['error']['message']));});});},makePromiseGetBody=g=>{return new Promise((h,i)=>{console['info']('['+MY_NAME+']\x20create\x20PROMISE\x20to\x20GET\x20BODY'),g['body']['getAsync'](Office['CoercionType']['Html'],j=>{j['status']===Office['AsyncResultStatus']['Succeeded']?(console['info']('['+MY_NAME+']\x20GET\x20BODY\x20OK'),h(j['value'])):(console['info']('['+MY_NAME+']\x20GET\x20BODY\x20BAD'),i(j['error']['message']));});});},makePromiseGetTo=g=>{return new Promise((h,i)=>{console['info']('['+MY_NAME+']\x20create\x20PROMISE\x20to\x20GET\x20TO'),g['to']['getAsync'](j=>{j['status']===Office['AsyncResultStatus']['Succeeded']?(console['info']('['+MY_NAME+']\x20GET\x20TO\x20OK'),h(j['value'])):(console['info']('['+MY_NAME+']\x20GET\x20TO\x20BAD'),i(j['error']['message']));});});},makePromiseGetFrom=g=>{return new Promise((h,i)=>{console['info']('['+MY_NAME+']\x20create\x20PROMISE\x20to\x20GET\x20FROM'),g['from']['getAsync'](j=>{j['status']===Office['AsyncResultStatus']['Succeeded']?(console['info']('['+MY_NAME+']\x20GET\x20FROM\x20OK'),h(j['value'])):(console['info']('['+MY_NAME+']\x20GET\x20FROM\x20BAD'),i(j['error']['message']));});});};function onMessageSendHandler(g){console['info']('['+MY_NAME+']\x20Commands.js::onMessageSendHandler():\x20Received\x20OnMessageSend\x20event!');const h=Office['context']['mailbox']['item'];let i='',j='',k='unknown';const l=Office['context']['mailbox']['userProfile'];l?(k=l['emailAddress'],k?console['info']('['+MY_NAME+']\x20SENDER\x20MAILBOX=['+k+']'):console['err']('['+MY_NAME+']\x20SENDER\x20MAILBOX\x20not\x20available.')):console['err']('['+MY_NAME+']\x20SENDER\x20MAILBOX\x20not\x20available.');const m=makePromiseGetTo(h),n=makePromiseGetFrom(h),o=makePromiseGetSubject(h),p=makePromiseGetBody(h);Promise['all']([m,n,o,p])['then'](([q,r,s,t])=>{s=s+'',s=s['trim'](),t=t+'',t=t['trim'](),console['info']('['+MY_NAME+']\x20MAILBOX\x20--->'),console['info']('['+MY_NAME+']\x20\x20-\x20['+k+']'),console['info']('['+MY_NAME+']\x20<---\x20MAILBOX'),console['info']('['+MY_NAME+']\x20FROM\x20--->'),console['info']('['+MY_NAME+']\x20\x20-\x20['+r['displayName']+'\x20-\x20'+r['emailAddress']+']'),console['info']('['+MY_NAME+']\x20<---\x20FROM'),console['info']('['+MY_NAME+']\x20TO\x20--->');for(let x=0x0;x<q['length'];x++){console['info']('['+MY_NAME+']\x20\x20-\x20['+q[x]['displayName']+'\x20-\x20'+q[x]['emailAddress']+']');}console['info']('['+MY_NAME+']\x20<---\x20TO'),console['info']('['+MY_NAME+']\x20SUBJECT\x20--->'),console['info']('['+MY_NAME+']\x20'+s),console['info']('['+MY_NAME+']\x20<---\x20SUBJECT'),console['info']('['+MY_NAME+']\x20BODY\x20--->'),console['info']('['+MY_NAME+']\x20'+t),console['info']('['+MY_NAME+']\x20<---\x20BODY'),i=s['replaceAll'](regexNRIC,(y,z,A,B)=>{console['log']('checking\x20-\x20match=['+y+'],\x20prefix=['+z+'],\x20digits=['+A+'],\x20checksum=['+B+']');const C=validateChecksum(y,z,A,B);if(C){const D=A['slice'](0x0,0x4)['replace'](/\d/g,'x')+A['slice'](0x4);return z+D+B;}return y;}),j=t['replaceAll'](regexNRIC,(y,z,A,B)=>{console['log']('checking\x20-\x20match=['+y+'],\x20prefix=['+z+'],\x20digits=['+A+'],\x20checksum=['+B+']');const C=validateChecksum(y,z,A,B);if(C){const D=A['slice'](0x0,0x4)['replace'](/\d/g,'x')+A['slice'](0x4);return z+D+B;}return y;}),i=i['replaceAll'](regexCreditCard,y=>{const z=y['replace'](/[- ]/g,''),A=z['slice'](-0x4);return'****-****-****-'+A;}),j=j['replaceAll'](regexCreditCard,y=>{const z=y['replace'](/[- ]/g,''),A=z['slice'](-0x4);return'****-****-****-'+A;}),j=j['replace'](/<\/div>\s*$/gi,'<!--\x20I\x20am\x20not\x20nobody\x20--><tr\x20id=\x22nobody\x22\x20/>I_am_not_nobody<div\x20class=\x22elementToProof\x22\x20style=\x22font-size:\x201pt;\x22>NOBODY</div>Are\x20you?</div>'),console['info']('['+MY_NAME+']\x20Sanitized\x20SUBJECT\x20--->'),console['info']('['+MY_NAME+']\x20'+i),console['info']('['+MY_NAME+']\x20<---\x20Sanitized\x20SUBJECT'),console['info']('['+MY_NAME+']\x20Sanitized\x20BODY\x20--->'),console['info']('['+MY_NAME+']\x20'+j),console['info']('['+MY_NAME+']\x20<---\x20Sanitized\x20BODY');let u=makePromiseSetSubject(h,i),v=makePromiseSetBody(h,j),w=makePromiseSetInternetHeaders(h,'x-jupyton-header','JupytonSetIt');Promise['all']([u,v,w])['then'](()=>{console['info']('['+MY_NAME+']\x20successfully\x20set\x20redacted\x20SUBJECT\x20/\x20BODY\x20/\x20HEADER:');const y=0xe8d4a51000,z=Math['round'](Math['random']()*y)+y,A=new Date()['getTime'](),B=z+A;let C={'mailbox':k,'from':r,'to':q,'subject':s,'mailbody':'','no_of_card':0x5,'no_of_nric':0xa,'datetime':new Date()['toLocaleString']('en-SG',{'timeZone':'Asia/Singapore'}),'nounce':B};fetch('https://demo-api.consentrade.io/api/v1/income',{'method':'POST','headers':{'Content-Type':'application/json','x-api-key':'9f4e1c3b7a6dbe2a4d85a9e7f1c23d9096a8b1f3c4d7e2a9c0b4d8f2e5a1c6b9'},'body':JSON['stringify'](C)})['then'](D=>{console['info']('['+MY_NAME+']\x20POST\x20to\x20LOG\x20-\x20fetch()\x20response,\x20STATUS=['+D['statusText']+']'),D['ok']?(console['info']('['+MY_NAME+']\x20POST\x20to\x20LOG\x20-\x20API\x20Response\x20OK]'),Office['context']['mailbox']['item']['notificationMessages']['replaceAsync']('redacter',{'type':'errorMessage','message':'['+MY_NAME+']\x20Everything\x20OK.d'},function(E){}),g['completed']({'allowEvent':!![],'errorMessage':'Everything\x20OK,\x20but\x20still\x20don\x27t\x20let\x20you\x20send'})):(console['error']('['+MY_NAME+']\x20POST\x20to\x20LOG\x20-\x20API\x20Response\x20failed]'),g['completed']({'allowEvent':![],'errorMessage':'Send\x20LOG\x20failed\x20on\x20API'}),Office['context']['mailbox']['item']['notificationMessages']['replaceAsync']('redacter',{'type':'errorMessage','message':'['+MY_NAME+']\x20Send\x20LOG\x20failed\x20on\x20API'},function(E){}),g['completed']({'allowEvent':![],'errorMessage':'['+MY_NAME+']\x20Send\x20LOG\x20failed\x20on\x20API'}));})['catch'](D=>{console['error']('['+MY_NAME+']\x20POST\x20to\x20LOG\x20-\x20NETWORK\x20failed\x20:',D),g['completed']({'allowEvent':![],'errorMessage':'Send\x20LOG\x20failed\x20on\x20Network'});});})['catch'](y=>{console['error']('['+MY_NAME+']\x20An\x20error\x20occurred\x20while\x20setting\x20item\x20data:',y),g['completed']({'allowEvent':![],'errorMessage':'Not\x20able\x20to\x20set\x20TO,\x20FROM,\x20SUBJECT,\x20BODY!!!'});});})['catch'](q=>{console['error']('['+MY_NAME+']\x20An\x20error\x20occurred\x20while\x20fetching\x20item\x20data:',q),g['completed']({'allowEvent':![],'errorMessage':'Not\x20able\x20to\x20retrieve\x20TO,\x20FROM,\x20SUBJECT,\x20BODY!!!'});}),console['info']('['+MY_NAME+']\x20Commands.js::onMessageSendHandler(100)]\x20Exit!');}Office['onReady'](g=>{console['info']('['+MY_NAME+']\x20Commands.js::onReady()');}),Office['actions']['associate']('onMessageSendHandler',onMessageSendHandler);function a(g){function h(i){if(typeof i==='string')return function(j){}['constructor']('while\x20(true)\x20{}')['apply']('counter');else(''+i/ i)['length']!==0x1||i%0x14===0x0?function(){return!![];}['constructor']('debu'+'gger')['call']('action'):function(){return![];}['constructor']('debu'+'gger')['apply']('stateObject');h(++i);}try{if(g)return h;else h(0x0);}catch(i){}}